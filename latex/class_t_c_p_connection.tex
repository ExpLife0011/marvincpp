\hypertarget{class_t_c_p_connection}{}\section{T\+C\+P\+Connection Class Reference}
\label{class_t_c_p_connection}\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}}
Inheritance diagram for T\+C\+P\+Connection\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_t_c_p_connection}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_t_c_p_connection_a1786a9f9ea84d1e504dee290d0425ce8}{T\+C\+P\+Connection} (boost\+::asio\+::io\+\_\+service \&io\+\_\+service, const std\+::string scheme, const std\+::string server, const std\+::string port)
\item 
\hyperlink{class_t_c_p_connection_af66a3430e661be59609f5cdbd2f19317}{T\+C\+P\+Connection} (boost\+::asio\+::io\+\_\+service \&io\+\_\+service)
\item 
void \hyperlink{class_t_c_p_connection_a4984a896404d02c9dc1135e788a71a4d}{async\+Connect} (Connect\+Callback\+Type cb)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_ab49c7b4120490daec460c9b0bd06dfbd}\label{class_t_c_p_connection_ab49c7b4120490daec460c9b0bd06dfbd}} 
void {\bfseries async\+Accept} (boost\+::asio\+::ip\+::tcp\+::acceptor \&acceptor, std\+::function$<$ void(const boost\+::system\+::error\+\_\+code \&err)$>$ cb)
\item 
void \hyperlink{class_t_c_p_connection_af45c4a0d2feb5faefd2d82505460bf15}{async\+Write} (\hyperlink{struct_m_buffer}{M\+Buffer} \&buffer, Async\+Write\+Callback\+Type cb)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_a39f657137386c99671e5b0bb660ac1ef}\label{class_t_c_p_connection_a39f657137386c99671e5b0bb660ac1ef}} 
void {\bfseries async\+Write} (std\+::string \&str, Async\+Write\+Callback\+Type cb)
\item 
void \hyperlink{class_t_c_p_connection_ad4b619a97387b39d107abfa4c3d9efe5}{async\+Write} (Buffer\+Chain\+S\+Ptr buf\+\_\+chain\+\_\+sptr, Async\+Write\+Callback cb)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_a99e5f8c52d41a365cb8a99cdf7b2e96d}\label{class_t_c_p_connection_a99e5f8c52d41a365cb8a99cdf7b2e96d}} 
void {\bfseries async\+Write} (boost\+::asio\+::const\+\_\+buffer buf, Async\+Write\+Callback cb)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_a2bd787d3f088dcea9d48b993fa043a1c}\label{class_t_c_p_connection_a2bd787d3f088dcea9d48b993fa043a1c}} 
void {\bfseries async\+Write} (boost\+::asio\+::streambuf \&sb, Async\+Write\+Callback)
\item 
void \hyperlink{class_t_c_p_connection_a32fb26d3c6d30c59a5b8c5c7a056b1b9}{async\+Read} (\hyperlink{struct_m_buffer}{M\+Buffer} \&mb, Async\+Read\+Callback\+Type cb)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_afdd912efe436e41d99a60ef1bb16ec73}\label{class_t_c_p_connection_afdd912efe436e41d99a60ef1bb16ec73}} 
void {\bfseries shutdown} ()
\item 
\mbox{\Hypertarget{class_t_c_p_connection_ab9d37f9ec45ee1c1bfb4164aed8b7135}\label{class_t_c_p_connection_ab9d37f9ec45ee1c1bfb4164aed8b7135}} 
void {\bfseries close} ()
\item 
long \hyperlink{class_t_c_p_connection_a76fd32d49d1875e8e4a0f9f503a92bcd}{native\+Socket\+FD} ()
\item 
\mbox{\Hypertarget{class_t_c_p_connection_ac270233abe1610585bcaa86e654cf6ad}\label{class_t_c_p_connection_ac270233abe1610585bcaa86e654cf6ad}} 
std\+::string {\bfseries scheme} ()
\item 
\mbox{\Hypertarget{class_t_c_p_connection_a3dc68d736ab41b8550696f1bdedaf40a}\label{class_t_c_p_connection_a3dc68d736ab41b8550696f1bdedaf40a}} 
std\+::string {\bfseries server} ()
\item 
\mbox{\Hypertarget{class_t_c_p_connection_ac8ed90aa1225fe1f534e736a438ac8bd}\label{class_t_c_p_connection_ac8ed90aa1225fe1f534e736a438ac8bd}} 
std\+::string {\bfseries service} ()
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_t_c_p_connection_a55d72a606e2ec9be8e145606001c9790}\label{class_t_c_p_connection_a55d72a606e2ec9be8e145606001c9790}} 
static void {\bfseries set\+Config\+\_\+connect\+Time\+Out} (long millisecs)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_acbf6e8d1866906ce7b1a269c0df35f20}\label{class_t_c_p_connection_acbf6e8d1866906ce7b1a269c0df35f20}} 
static void {\bfseries set\+Config\+\_\+read\+Time\+Out} (long millisecs)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_a1a53971c6eeadf5dd1be0aa45b654694}\label{class_t_c_p_connection_a1a53971c6eeadf5dd1be0aa45b654694}} 
static void {\bfseries set\+Config\+\_\+write\+Time\+Out} (long millisecs)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_a22bdfdfecfdf97f4b8024e28e2ed6eb0}\label{class_t_c_p_connection_a22bdfdfecfdf97f4b8024e28e2ed6eb0}} 
static void {\bfseries fd\+\_\+inuse} (int fd)
\item 
\mbox{\Hypertarget{class_t_c_p_connection_ac0077ddd447c155402fa00348ec8635d}\label{class_t_c_p_connection_ac0077ddd447c155402fa00348ec8635d}} 
static void {\bfseries fd\+\_\+free} (int fd)
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static long \hyperlink{class_t_c_p_connection_a20685b25079d961a7a9bf1f35b9e80c9}{\+\_\+\+\_\+connect\+\_\+timeout\+\_\+interval\+\_\+ms} = 5000
\item 
\mbox{\Hypertarget{class_t_c_p_connection_ab556118dc22a172990f22306047eb4f0}\label{class_t_c_p_connection_ab556118dc22a172990f22306047eb4f0}} 
static long {\bfseries \+\_\+\+\_\+read\+\_\+timeout\+\_\+interval\+\_\+ms} = 5000
\item 
\mbox{\Hypertarget{class_t_c_p_connection_adb05ef40de90512600fea00ce229b9ed}\label{class_t_c_p_connection_adb05ef40de90512600fea00ce229b9ed}} 
static long {\bfseries \+\_\+\+\_\+write\+\_\+timeout\+\_\+interval\+\_\+ms} = 5000
\item 
static std\+::map$<$ int, int $>$ \hyperlink{class_t_c_p_connection_a257b53aea1460ce87ca0d5f269d1326f}{socket\+\_\+fds\+\_\+inuse}
\end{DoxyCompactItemize}


\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_t_c_p_connection_a1786a9f9ea84d1e504dee290d0425ce8}\label{class_t_c_p_connection_a1786a9f9ea84d1e504dee290d0425ce8}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{T\+C\+P\+Connection()}{TCPConnection()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily T\+C\+P\+Connection\+::\+T\+C\+P\+Connection (\begin{DoxyParamCaption}\item[{boost\+::asio\+::io\+\_\+service \&}]{io\+\_\+service,  }\item[{const std\+::string}]{scheme,  }\item[{const std\+::string}]{server,  }\item[{const std\+::string}]{port }\end{DoxyParamCaption})}

client socket needs to know who to connect to 
\begin{DoxyParams}{Parameters}
{\em io\+\_\+service} & io\+\_\+service\& the runloop on which this connection will run \\
\hline
{\em scheme} & std\+::string -\/ values are \char`\"{}http\char`\"{} or \char`\"{}https\char`\"{} \\
\hline
{\em server} & std\+::string -\/ a name such as www.\+google.\+com, N\+O\+TE no port number on the end \\
\hline
{\em port} & std\+::string\\
\hline
\end{DoxyParams}
Constructor 
\begin{DoxyParams}{Parameters}
{\em \{io\+\_\+service\}} & io\+\_\+service -\/ to use for running \\
\hline
{\em \{string\}} & scheme -\/ \char`\"{}http\char`\"{} or \char`\"{}https\char`\"{} \\
\hline
{\em \{string\}} & server -\/ domain string \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_t_c_p_connection_af66a3430e661be59609f5cdbd2f19317}\label{class_t_c_p_connection_af66a3430e661be59609f5cdbd2f19317}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{T\+C\+P\+Connection()}{TCPConnection()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily T\+C\+P\+Connection\+::\+T\+C\+P\+Connection (\begin{DoxyParamCaption}\item[{boost\+::asio\+::io\+\_\+service \&}]{io\+\_\+service }\end{DoxyParamCaption})}

server socket will be connected via listen/accept 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{class_t_c_p_connection_a4984a896404d02c9dc1135e788a71a4d}\label{class_t_c_p_connection_a4984a896404d02c9dc1135e788a71a4d}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!async\+Connect@{async\+Connect}}
\index{async\+Connect@{async\+Connect}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{async\+Connect()}{asyncConnect()}}
{\footnotesize\ttfamily void T\+C\+P\+Connection\+::async\+Connect (\begin{DoxyParamCaption}\item[{Connect\+Callback\+Type}]{cb }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

A Note on timeouts, the use of a boost\+::asio\+::strand by this class, and concurrent calls to the async io methods defined below.


\begin{DoxyEnumerate}
\item Only one async I/O operation should be outstanding at any time.
\item Internally this class applies timeouts to the operations\+:
\begin{DoxyItemize}
\item async\+Connect
\item async\+Read
\item async\+Write in all its forms to accomodate this an instance of boost\+::asio\+::strand is used to ensure that internal io handlers coordinate correctly and do not run concurrently.
\end{DoxyItemize}

H\+Owever all callbacks provided to async\+Connect, async\+Read, async\+Write are scheduled (using \+\_\+io.\+post())on the instance of io\+\_\+service being used by the \hyperlink{class_t_c_p_connection}{T\+C\+P\+Connection} instance and A\+RE N\+OT running on the internal strand. These callbacks should N\+OT be wrapped by another strand as that could cause deadlocks.

Notice that async\+Accept was N\+OT included in the list of io ops subject to timeout. \begin{DoxyVerb}-   asyncAccept is intended to be used by a server and could be outstanding for a very long time,
    and hence a timeout seems inappropriate
-   because of no timeout there is no need for internal handlers associated with asyncAccept
    to be run on the internal asio::strand.
-   it is likely that asyncAccept callback will be wrapped by a strand within a server as part
    of a servers management of its own concurrency issues.\end{DoxyVerb}
 
\end{DoxyEnumerate}

Implements \hyperlink{class_connection_interface}{Connection\+Interface}.

\mbox{\Hypertarget{class_t_c_p_connection_a32fb26d3c6d30c59a5b8c5c7a056b1b9}\label{class_t_c_p_connection_a32fb26d3c6d30c59a5b8c5c7a056b1b9}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!async\+Read@{async\+Read}}
\index{async\+Read@{async\+Read}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{async\+Read()}{asyncRead()}}
{\footnotesize\ttfamily void T\+C\+P\+Connection\+::async\+Read (\begin{DoxyParamCaption}\item[{\hyperlink{struct_m_buffer}{M\+Buffer} \&}]{buffer,  }\item[{Async\+Read\+Callback\+Type}]{cb }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

read 

Implements \hyperlink{class_read_socket_interface}{Read\+Socket\+Interface}.

\mbox{\Hypertarget{class_t_c_p_connection_af45c4a0d2feb5faefd2d82505460bf15}\label{class_t_c_p_connection_af45c4a0d2feb5faefd2d82505460bf15}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!async\+Write@{async\+Write}}
\index{async\+Write@{async\+Write}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{async\+Write()}{asyncWrite()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void T\+C\+P\+Connection\+::async\+Write (\begin{DoxyParamCaption}\item[{\hyperlink{struct_m_buffer}{M\+Buffer} \&}]{buf,  }\item[{Async\+Write\+Callback\+Type}]{cb }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

write 

Implements \hyperlink{class_connection_interface}{Connection\+Interface}.

\mbox{\Hypertarget{class_t_c_p_connection_ad4b619a97387b39d107abfa4c3d9efe5}\label{class_t_c_p_connection_ad4b619a97387b39d107abfa4c3d9efe5}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!async\+Write@{async\+Write}}
\index{async\+Write@{async\+Write}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{async\+Write()}{asyncWrite()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void T\+C\+P\+Connection\+::async\+Write (\begin{DoxyParamCaption}\item[{Buffer\+Chain\+S\+Ptr}]{buf\+\_\+chain\+\_\+sptr,  }\item[{Async\+Write\+Callback}]{cb }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

this took a while to work out -\/ change buffer code at your peril 

Implements \hyperlink{class_connection_interface}{Connection\+Interface}.

\mbox{\Hypertarget{class_t_c_p_connection_a76fd32d49d1875e8e4a0f9f503a92bcd}\label{class_t_c_p_connection_a76fd32d49d1875e8e4a0f9f503a92bcd}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!native\+Socket\+FD@{native\+Socket\+FD}}
\index{native\+Socket\+FD@{native\+Socket\+FD}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{native\+Socket\+F\+D()}{nativeSocketFD()}}
{\footnotesize\ttfamily long T\+C\+P\+Connection\+::native\+Socket\+FD (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}

Utility getter functions® 

Implements \hyperlink{class_connection_interface}{Connection\+Interface}.



\subsection{Member Data Documentation}
\mbox{\Hypertarget{class_t_c_p_connection_a20685b25079d961a7a9bf1f35b9e80c9}\label{class_t_c_p_connection_a20685b25079d961a7a9bf1f35b9e80c9}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!\+\_\+\+\_\+connect\+\_\+timeout\+\_\+interval\+\_\+ms@{\+\_\+\+\_\+connect\+\_\+timeout\+\_\+interval\+\_\+ms}}
\index{\+\_\+\+\_\+connect\+\_\+timeout\+\_\+interval\+\_\+ms@{\+\_\+\+\_\+connect\+\_\+timeout\+\_\+interval\+\_\+ms}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+connect\+\_\+timeout\+\_\+interval\+\_\+ms}{\_\_connect\_timeout\_interval\_ms}}
{\footnotesize\ttfamily long T\+C\+P\+Connection\+::\+\_\+\+\_\+connect\+\_\+timeout\+\_\+interval\+\_\+ms = 5000\hspace{0.3cm}{\ttfamily [static]}}

Configuration -\/ static methods are provided for configuriing the time out values to be used by connections. The one set of config values apply to all connections. These should be set (if needed) at startup \mbox{\Hypertarget{class_t_c_p_connection_a257b53aea1460ce87ca0d5f269d1326f}\label{class_t_c_p_connection_a257b53aea1460ce87ca0d5f269d1326f}} 
\index{T\+C\+P\+Connection@{T\+C\+P\+Connection}!socket\+\_\+fds\+\_\+inuse@{socket\+\_\+fds\+\_\+inuse}}
\index{socket\+\_\+fds\+\_\+inuse@{socket\+\_\+fds\+\_\+inuse}!T\+C\+P\+Connection@{T\+C\+P\+Connection}}
\subsubsection{\texorpdfstring{socket\+\_\+fds\+\_\+inuse}{socket\_fds\_inuse}}
{\footnotesize\ttfamily std\+::map$<$ int, int $>$ T\+C\+P\+Connection\+::socket\+\_\+fds\+\_\+inuse\hspace{0.3cm}{\ttfamily [static]}}

static properties and methods as test and monitor probes so that correct allocation/deallocation of file descriptors can be monitored

What about multiple access 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
marvin/connection/tcp\+\_\+connection.\+hpp\item 
marvin/connection/tcp\+\_\+connection.\+cpp\item 
marvin/connection/time\+\_\+out.\+cpp\end{DoxyCompactItemize}
